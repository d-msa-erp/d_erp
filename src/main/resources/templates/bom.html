<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>BOM 관리</title>
	<th:block th:replace="~{/icon.html :: iconInclude}"></th:block>
	<style th:replace="~{/top.html :: topstyle}"></style>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: sans-serif;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}

		.site-Wrapper {
			width: 100%;
			max-width: 1200px;
			align-self: center;
			padding: 20px;
		}

		.site-Dataset {
			width: 100%;
			border: 1px solid #777;
			border-radius: 10px;
			overflow: hidden;
			display: flex;
			flex-direction: column;
		}

		.site-Dataset .header {
			background: #46a6ff;
			color: white;
			padding: 10px 20px;
			font-size: 20px;
		}

		.site-Dataset .form-content {
			display: flex;
			flex-wrap: wrap;
			padding: 20px;
			gap: 20px;
		}

		.form-item {
			display: flex;
			align-items: center;
			width: calc(33.333% - 13.33px);
		}

		.form-item.addr {
			width: calc(66.666% - 10px);
		}

		.form-item span {
			padding-right: 10px;
			white-space: nowrap;
		}

		.form-item input {
			width: 100%;
			height: 100%;
			border-radius: 3px;
			padding: 5px;
			font-size: 14px;
			border: 1px solid #ccc;
		}

		.form-item input:focus {
			border: 1px solid #46a6ff;
			outline: none;
		}

		.table-wrapper {
			width: 100%;
			max-width: 1200px;
		}

		.table-wrapper>div:nth-child(1) {
			padding: 20px 20px 0 20px;
			display: flex;
			justify-content: flex-end;
			gap: 20px;
			position: relative;
		}

		.table-wrapper>div:nth-child(1)>input[type="text"] {
			width: 30%;
			padding: 5px;
		}

		.table-wrapper>div:nth-child(1)>div {
			width: 30%;
			display: flex;
			justify-content: space-between;
		}

		.table-wrapper>div:nth-child(1)>.btn-wrap1 {
			background: #fff;
			border: none;
			border-radius: 5px;
			position: absolute;
			left: 20px;
			display: flex;
			justify-content: flex-start;
			gap: 10px;
		}

		.table-wrapper>div:nth-child(1)>div button {
			width: 30%;
			background: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			white-space: nowrap;
		}

		.table-wrapper>div:nth-child(1)>.btn-wrap1 button {
			padding: 5px;
			gap: 10px;
			background: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			white-space: nowrap;
		}

		.table-wrapper>div:nth-child(1)>div button:nth-child(1) {
			background: #007bff;
			color: white;
		}

		.table-wrapper>div:nth-child(1)>div button:nth-child(2) {
			background: #28a745;
			color: white;
		}

		.table-wrapper>div:nth-child(1)>div button:nth-child(3) {
			background: #dc3545;
			color: white;
		}

		.table-wrapper>div:nth-child(2) {
			padding: 20px 20px 0 20px;
			display: flex;
			flex-direction: column;
		}

		.table-wrapper>div:nth-child(2)>span {
			width: 30%;
			padding-right: 10px;
			text-align: center;
			cursor: pointer;
		}

		.table-wrapper>div:nth-child(2)>span.active {
			font-weight: bold;
			text-decoration: underline;
		}

		.table-wrapper>div:nth-child(3) {
			position: relative;
		}

		.nodata {
			text-align: center;
		}

		.print-wrap {
			position: absolute;
			top: 0;
			right: 0;
			padding: 0 20px;
			display: flex;
			gap: 10px;
			width: 200px;
		}

		.print-wrap>button {
			width: 100%;
			background: #007bff;
			color: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			padding: 5px;
		}

		table.grid-table {
			width: 100%;
			border-collapse: collapse;
			display: grid;
			grid-template-columns: 1fr 2fr 2fr 2fr 1fr 1fr 1fr;
		}

		thead,
		tbody,
		tr {
			display: contents;
		}

		tbody>tr:nth-child(even) td {
			background: #f9f9f9;
		}

		tbody>tr:hover td {
			background: #46a6ff;
			cursor: pointer;
		}

		tr th:nth-child(1),
		tr td:nth-child(1),
		tr th:nth-last-child(1) {
			justify-content: center;
		}

		tr td:nth-last-child(1) {
			justify-content: right;
		}

		th,
		td {
			padding: 10px;
			border: 1px solid #ccc;
			display: flex;
			align-items: center;
		}

		thead th {
			background: #f0f0f0;
			font-weight: bold;
			cursor: pointer;
		}

		table input[type="text"] {
			width: 100%;
			padding: 5px;
		}

		.pagination-wrap {
			display: flex;
			flex-direction: column;
			align-items: flex-end;
			padding-top: 20px;
		}

		.pagination-wrap>div {
			display: flex;
			align-items: center;
			gap: 10px;
		}

		.pagination-wrap>div input[type="text"] {
			width: 50px;
			text-align: center;
		}

		.pagination-wrap>div button {
			width: 40px;
			background: #007bff;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 2px;
			font-size: 16px;
		}

		.table-wrapper button:hover {
			filter: brightness(0.9);
		}

		.modal {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			background: rgba(0, 0, 0, 0.4);
			justify-content: center;
			align-items: center;
			backdrop-filter: blur(4px);
			-webkit-backdrop-filter: blur(4px);
		}

		.modal-content {
			background: white;
			padding: 20px;
			border-radius: 10px;
			width: 80%;
			position: relative;
		}

		.modal-content .modalForm {
			margin-top: 20px;
			display: flex;
			flex-direction: column;
			gap: 20px;
			justify-items: center;
			align-items: center;
		}

		.modal-content .modalForm>div,
		.modal-content .modalForm>label {
			width: 100%;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.modal-content .modalForm>div>span,
		.modal-content .modalForm>label>span {
			white-space: nowrap;
			padding-right: 10px;
		}

		.modal-content input[type="text"] {
			width: 100%;
			padding: 10px;
			border: 1px solid #ccc;
		}

		.modal-content input[type="color"] {
			width: 100%;
			height: 40px;
			border: none;
			margin-top: 10px;
		}

		.modal-content .modal-buttons {
			margin-top: 15px;
			display: flex;
			justify-content: flex-end;
			gap: 10px;
			width: 100%;
		}

		.modal-content .modal-buttons>button:hover {
			filter: brightness(0.9);
		}

		.modal-content .modal-buttons>button {
			width: 100%;
			background: #007bff;
			color: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			padding: 5px;
		}

		.modal-buttons button:nth-of-type(3) {
			background: #777 !important;
		}

		.modal-content .modalForm th,
		.modal-content .modalForm td {
			margin: 0 !important;
			padding: 0 !important;
			width: 100% !important;
			height: 100% !important;
		}

		.modal-content .bomTab1 select {
			height: 100%;
			width: 100%;
		}

		.modal-content .grid-table {
			width: 100%;
			height: 100%;
			border-collapse: collapse;
			display: grid;
			grid-template-columns: 1fr 2fr 2fr 1fr 1fr 1fr;
			padding: 0;
		}

		.modal-content .grid-table button {
			width: 100%;
			height: 100%;
		}

		.bomTab1 {
			display: grid !important;
			grid-template-columns: 1fr 1fr;
			gap: 10px;
		}

		.bomTab1 input {
			height: 100%;
			width: 100%;
			padding: 5px;
		}

		.bomTab1>div {
			height: 100%;
			align-self: stretch;
		}

		.bomTab2 {
			display: grid;
			grid-template-columns: 2.7fr 1fr;
			gap: 10px;
		}

		.bomTab2>div {
			display: flex;
			flex-direction: column;
			gap: 10px !important;
			justify-content: space-between;
			overflow-y: auto;
		}

		.bomTab2>div>div {
			height: 100%;
		}

		.bomTab2>div>ul {
			display: flex;
			flex-direction: column;
			height: 100%;
		}

		.bomTab2>div>ul>li {
			padding-left: 10px;
		}

		.bomTab3 {
			display: flex;
			flex-direction: column;
			gap: 10px;
		}

		.bomTab3>div {
			display: flex;
			white-space: nowrap;
			gap: 10px;
			align-items: center;
		}

		.bomTab3 .flex-row {
			display: flex;
			gap: 10px;
			width: 100%;
		}

		.bomTab3 .flex-row>div {
			flex: 1;
			display: flex;
			align-items: center;
		}

		.bomTab3 .flex-row>div span {
			white-space: nowrap;
			padding-right: 10px;
		}

		.bomTab3 .flex-row>div input {
			width: 100%;
		}

		.bomTab5 {
			max-height: 300px;
			overflow-y: auto;
		}

		.bomTab5 .grid-table {
			grid-template-columns: 1fr 2fr 2fr 1fr 1fr 1fr 1fr 1fr;
		}

		.catetable {
			grid-template-columns: 1fr 1fr 1fr 1fr !important;
		}

		.stretable {
			grid-template-columns: 1fr 1fr 1fr !important;
		}

		.modal-content h3 {
			margin-bottom: 10px;
		}

		.modalForm {
			display: flex;
			flex-direction: column;
		}

		#category-table {
			grid-template-columns: 0.3fr 1fr 1fr 1fr 1fr 0.3fr !important;
		}

		#category-table input[type="text"] {
			width: 98%;
		}

		#category-table td {
			padding: 0 !important;
			display: flex;
			flex-direction: column-reverse;
			max-height: 113px;
			justify-content: center;
		}

		#category-table .grid-table {
			background: #f9f9f9;
			grid-template-columns: 1.2fr 1fr 1fr 0.7fr !important;
			margin: 0 !important;
			max-height: 69px;
	overflow: auto;
		}

		#category-table .grid-table th {
			font-size: 13px;
		}

		.subcategory-tbody input[type="text"] {
			width: 95%;
		}


		.category-sub-add {
			display: grid;
			grid-template-columns: 1.2fr 1fr 0.7fr !important;
			gap: 6px;
			margin-top: 4px;
		}

		.category-sub-add button {
			width: auto;
		}

		.category-sub-add input {
			flex: 1;
		}

		.category-add-row {
			display: flex;
			gap: 10px;
			margin-top: 10px;
		}

		.category-add-row input {
			flex: 1;
		}

		.modal-buttons button {
			margin-right: 10px;
		}
	</style>

</head>

<body>
	<div th:replace="~{/top.html :: top}"></div>
	<div class="site-Wrapper">
		<h1 style="font-size: 24px; margin-bottom: 16px;">BOM 관리</h1>
		<form id="frm" method="get" action="#">
			<div class="site-Dataset">
				<div class="header">
					<h4 style="margin: 0;">BOM 관리</h4>
				</div>
				<div class="table-wrapper">
					<div>
						<div class="btn-wrap1">
							<button type="button" onclick="openCategoryModal()">
								<span class="material-symbols-outlined">category</span> 분류관리
							</button>
							<button type="button" onclick="openSpecModal()">
								<span class="material-symbols-outlined">straighten</span> 단위관리
							</button>
						</div>
						<input type="text" placeholder="검색" />
						<div>
							<button type="button">
								<span class="material-symbols-outlined">search</span> 검색
							</button>
							<button type="button" onclick="openModal()">
								<span class="material-symbols-outlined">add</span> 신규등록
							</button>
							<button type="button">
								<span class="material-symbols-outlined">delete</span> 삭제
							</button>
						</div>
					</div>
					<div></div>
					<div id="table-customer" style="padding: 20px; position: relative;">
						<div class="print-wrap">
							<button type="button">
								<span class="material-symbols-outlined">table_view</span> 엑셀
							</button>
							<button type="button">
								<span class="material-symbols-outlined">print</span> 인쇄
							</button>
						</div>
						<p class="nodata">등록된 데이터가 없습니다.</p>
						<!--데이터 없을 땐 이렇게 표기-->
						<table class="grid-table">

							<thead>

								<tr>
									<th><input type="checkbox" /></th>
									<th onclick="order(this)">품목코드<a>↓</a></th>
									<th onclick="order(this)">품목명<a>↓</a></th>
									<th onclick="order(this)">고객사<a>↓</a></th>
									<th onclick="order(this)">대분류<a>↓</a></th>
									<th onclick="order(this)">단위<a>↓</a></th>
									<th onclick="order(this)">단가<a>↓</a></th>
								</tr>
							</thead>
							<tbody>
								<!--몇개씩 자를지는 상의해봐요 ~ -->
								<tr onclick="opendatail()">
									<td><input type="checkbox" /></td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>10000000</td>
								</tr>
								<tr>
									<td><input type="checkbox" /></td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>test</td>
									<td>100000000</td>
								</tr>
							</tbody>
						</table>
						<div class="pagination-wrap">
							총 n건 1/n페이지
							<div class="paigination">
								<button type="button" id="btn-prev-page">
									<span class="material-symbols-outlined">chevron_left</span>
								</button>
								<input type="text" value="1" />
								<button type="button" id="btn-next-page">
									<span class="material-symbols-outlined">chevron_right</span>
								</button>
							</div>
						</div>
					</div>


				</div>
			</div>
		</form>
	</div>

	<!--신규 등록 Modal-->
	<div class="modal" id="modal" onclick="outsideClick(event,'modal')">
		<div class="modal-content" onclick="event.stopPropagation()">
			<h3 id="modalTitle">신규 BOM 등록</h3>
			<form id="modalForm" class="modalForm">
				<div class="bomTab1">
					<div class="bomTab2">
						<div>
							<div>
								<table class="grid-table">
									<thead>
										<tr>
											<th>No</th>
											<th>품목코드</th>
											<th>품목명</th>
											<th>규격</th>
											<th>단위</th>
											<th>선택</th>
										</tr>
									</thead>
									<tbody>
										<!--등록된 품목 리스트가 쭉 나오게 ~ -->
										<tr>
											<td>1</td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><select>
													<option value="">--</option>
													<option value="g">g</option>
													<option value="kg">kg</option>
													<option value="mL">mL</option>
													<option value="L">L</option>
													<option value="ea">ea</option>
												</select></td>
											<td><input type="checkbox" /></td>
										</tr>

										<tr>
											<td>2</td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><select>
													<option value="">--</option>
													<option value="g">g</option>
													<option value="kg">kg</option>
													<option value="mL">mL</option>
													<option value="L">L</option>
													<option value="ea">ea</option>
												</select></td>
											<td><input type="checkbox" /></td>
										</tr>
									</tbody>
								</table>

							</div>
							<div>
								<table class="grid-table">
									<thead>
										<tr>
											<th>No</th>
											<th>자재코드</th>
											<th>자재명</th>
											<th>규격</th>
											<th>단위</th>
											<th>선택</th>
										</tr>
									</thead>
									<tbody>
										<!--등록된 자재 리스트가 쭉 나오게 ~ -->
										<tr>
											<td>1</td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><select>
													<option value="">--</option>
													<option value="g">g</option>
													<option value="kg">kg</option>
													<option value="mL">mL</option>
													<option value="L">L</option>
													<option value="ea">ea</option>
												</select></td>
											<td><input type="checkbox" /></td>
										</tr>
										<tr>
											<td>2</td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><input type="text" value="test" /></td>
											<td><select>
													<option value="">--</option>
													<option value="g">g</option>
													<option value="kg">kg</option>
													<option value="mL">mL</option>
													<option value="L">L</option>
													<option value="ea">ea</option>
												</select></td>
											<td><input type="checkbox" /></td>
										</tr>
									</tbody>
								</table>

							</div>
						</div>
						<div>
							<ul style="list-style: none;">
								품목
								<li>원자재1</li>
								<li>원자재2</li>
								<li>원자재3</li>
								<li>원자재4</li>
							</ul>
						</div>
					</div>

					<div class="bomTab3">
						<div><span>품목코드</span><input type="text" /></div>
						<div><span>품목명</span><input type="text" /></div>
						<div class="flex-row">
							<div><span>원자재코드</span><input type="text" /></div>
							<div><span>순번</span><input type="text" /></div>
						</div>
						<div><span>원자재명</span><input type="text" /></div>
						<div class="flex-row">
							<div><span>소요량</span><input type="text" /></div>
							<div><span>재료비</span><input type="text" /></div>
						</div>
						<div class="flex-row">
							<div><span>로스율</span><input type="text" /></div>
							<div><span>생산성</span><input type="text" /></div>
						</div>
						<div><span>비고</span><input type="text" /></div>
					</div>

				</div>
				<div class="bomTab5">
					<div>
						<div>
							<table class="grid-table">
								<thead>
									<tr>
										<th>No</th>
										<th>품목명</th>
										<th>원자재명</th>
										<th>순번</th>
										<th>소요량</th>
										<th>로스율</th>
										<th>재료비</th>
										<th>비고</th>
									</tr>
								</thead>
								<tbody>
									<!--등록된 품목 리스트가 쭉 나오게 ~ -->
									<tr>
										<td>1</td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>

									</tr>
									<tr>
										<td>2</td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
									</tr>
									<tr>
										<td>3</td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
										<td><input type="text" value="test" /></td>
									</tr>

								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="modal-buttons">
					<button type="button" name="save">
						<span class="material-symbols-outlined">save</span> 등록
					</button>
					<button type="button" name="edit">
						<span class="material-symbols-outlined">edit</span> 수정
					</button>
					<button type="button" onclick="closeModal('modal')">
						<span class="material-symbols-outlined">close</span> 취소
					</button>
				</div>
			</form>
		</div>

	</div>


	<!-- 대분류/소분류 관리 Modal -->
	<div class="modal" id="modal-category" onclick="outsideClick(event, 'modal-category')">
		<div class="modal-content" onclick="event.stopPropagation()">
			<h3>분류 관리</h3>
			<form class="modalForm" onsubmit="return false;">
				<div>
					<table class="grid-table" id="category-table">
						<thead>
							<tr>
								<th>선택</th>
								<th>대분류명</th>
								<th>분류코드</th>
								<th>비고</th>
								<th>소분류</th>
								<th>삭제</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><input type="checkbox" class="category-checkbox"/></td>
								<td><input type="text" value="예시대분류" /></td>
								<td><input type="text" value="분류코드 111111" /></td>
								<td><input type="text" value="대분류 비고" /></td>
								<td>
									<table class="grid-table">
										<thead>
											<tr>
												<th>소분류명</th>
												<th>소분류코드</th>
												<th>비고</th>
												<th>삭제</th>
											</tr>
										</thead>
										<tbody class="subcategory-tbody">
											<tr>
												<td><input type="text" value="예시소분류1" /></td>
												<td><input type="text" value="소분류코드1" /></td>
												<td><input type="text" value="소분류비고1" /></td>
												<td><button type="button" onclick="removeSubCategoryRow(this)">삭제</button></td>
											</tr>
											<tr>
												<td><input type="text" value="예시소분류2" /></td>
												<td><input type="text" value="예시소코드2" /></td>
												<td><input type="text" value="소분류비고2" /></td>
												<td><button type="button" onclick="removeSubCategoryRow(this)">삭제</button></td>
											</tr>
										</tbody>
									</table>
								</td>
								<td><button type="button" onclick="removeCategoryRow(this)">삭제</button></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="category-add-row">
					<input type="text" id="new-category" placeholder="새 대분류명" required />
					<input type="text" id="new-category-memo" placeholder="비고" />
					<button type="button" onclick="addCategoryRow()">
						<span class="material-symbols-outlined">add</span> 대분류 추가
					</button>
				</div>
				<div class="category-add-row">
					<input type="text" id="new-subcategory-name" placeholder="소분류명" />
					<input type="text" id="new-subcategory-memo" placeholder="비고" />
					<button type="button" onclick="addSubCategoryToChecked()">
						<span class="material-symbols-outlined">add</span> 소분류 추가
					</button>
				</div>
				<div class="modal-buttons">
					<button type="button"><span class="material-symbols-outlined">save</span> 등록</button>
					<button type="button" onclick="closeModal('modal-category')"><span class="material-symbols-outlined">close</span> 닫기</button>
				</div>
			</form>
		</div>
	</div>
	<script>
		// 체크박스 선택된 대분류에 소분류 추가
		function addSubCategoryToChecked() {
			const nameInput = document.getElementById('new-subcategory-name');
			const memoInput = document.getElementById('new-subcategory-memo');
			const name = nameInput.value.trim();
			const memo = memoInput.value.trim();
			if (!name) return;
			const checkboxes = document.querySelectorAll('#category-table .category-checkbox:checked');
			if (checkboxes.length === 0) {
				alert('소분류를 추가할 대분류를 체크하세요.');
				return;
			}
			checkboxes.forEach(cb => {
				const tr = cb.closest('tr');
				const tbody = tr.querySelector('.subcategory-tbody');
				const newTr = document.createElement('tr');
				newTr.innerHTML = `
					<td><input type="text" value="${name}" /></td>
					<td><input type="text" value="${memo}" /></td>
					<td><button type="button" onclick="removeSubCategoryRow(this)">삭제</button></td>
				`;
				tbody.appendChild(newTr);
			});
			nameInput.value = '';
			memoInput.value = '';
		}
	</script>
	<script>
		// 대분류 추가
		function addCategoryRow() {
			const input = document.getElementById('new-category');
			const memoInput = document.getElementById('new-category-memo');
			const value = input.value.trim();
			const memo = memoInput.value.trim();
			if (!value) return;
			const table = document.getElementById('category-table').getElementsByTagName('tbody')[0];
			const row = table.insertRow();
			row.innerHTML = `
				<td><input type="checkbox" class="category-checkbox"/></td>
				<td><input type="text" value="${value}" style="width:98%;" /></td>
				<td><input type="text" value="" style="width:98%;" /></td>
				<td><input type="text" value="${memo}" style="width:98%;" /></td>
				<td style="padding:0 !important; display:flex; flex-direction:column;">
					<table class="grid-table" style="background:#f9f9f9; grid-template-columns: 1.2fr 1fr 0.7fr !important; margin:0 !important;">
						<thead>
							<tr>
								<th style="font-size:13px;">소분류명</th>
								<th style="font-size:13px;">비고</th>
								<th style="font-size:13px;">삭제</th>
							</tr>
						</thead>
						<tbody class="subcategory-tbody"></tbody>
					</table>
				</td>
				<td><button type="button" onclick="removeCategoryRow(this)">삭제</button></td>
			`;
			input.value = '';
			memoInput.value = '';
			updateCategoryRowNumbers();
		}
		// 대분류 삭제
		function removeCategoryRow(btn) {
			const row = btn.closest('tr');
			row.parentNode.removeChild(row);
			updateCategoryRowNumbers();
		}
		function updateCategoryRowNumbers() {
			const table = document.getElementById('category-table').getElementsByTagName('tbody')[0];
			Array.from(table.rows).forEach((row, idx) => {
				// 번호 대신 체크박스이므로 아무것도 하지 않음
			});
		}
		// 소분류 추가 (개별 대분류 행 내에서)
		function addSubCategoryRow(btn) {
			const container = btn.closest('td');
			const nameInput = container.querySelector('.new-subcategory-input');
			const memoInput = container.querySelector('.new-subcategory-memo');
			const name = nameInput.value.trim();
			const memo = memoInput.value.trim();
			if (!name) return;
			const tbody = container.parentElement.querySelector('.subcategory-tbody');
			const tr = document.createElement('tr');
			tr.innerHTML = `
				<td><input type="text" value="${name}" style="width:95%;" /></td>
				<td><input type="text" value="${memo}" style="width:95%;" /></td>
				<td><button type="button" onclick="removeSubCategoryRow(this)">삭제</button></td>
			`;
			tbody.appendChild(tr);
			nameInput.value = '';
			memoInput.value = '';
		}
		// 소분류 삭제
		function removeSubCategoryRow(btn) {
			const tr = btn.closest('tr');
			tr.parentNode.removeChild(tr);
		}
	</script>

	<!-- 단위관리 Modal -->
	<div class="modal" id="modal-spec" onclick="outsideClick(event, 'modal-spec')">
		<div class="modal-content" onclick="event.stopPropagation()">
			<h3>단위 관리</h3>
			<form class="modalForm" onsubmit="addSpecUnit(event)">
				<div>
					<table class="grid-table stretable" id="spec-table">
						<thead>
							<tr>
								<th>No</th>
								<th>규격명</th>
								<th>삭제</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>1</td>
								<td><input type="text" value="ea" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
							<tr>
								<td>2</td>
								<td><input type="text" value="kg" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
							<tr>
								<td>3</td>
								<td><input type="text" value="g" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
							<tr>
								<td>4</td>
								<td><input type="text" value="cm" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
							<tr>
								<td>5</td>
								<td><input type="text" value="mL" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
							<tr>
								<td>6</td>
								<td><input type="text" value="L" /></td>
								<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div style="display:flex; gap:10px; margin-top:10px;"></div>
				<input type="text" id="new-spec-unit" placeholder="새 단위 입력" style="flex:1;" required />
				<div class="modal-buttons">
					<button type="submit"><span class="material-symbols-outlined">add</span> 추가</button><!--추가는 진짜 추가만 되는거고-->
					<button type="button" onclick="closeModal('modal-spec')"><span class="material-symbols-outlined">close</span> 닫기</button>
				</div>
				</form>
		</div>
		
	</div>
	
	<script>
		function addSpecUnit(event) {
			event.preventDefault();
			const input = document.getElementById('new-spec-unit');
			const value = input.value.trim();
			if (!value) return;
			const table = document.getElementById('spec-table').getElementsByTagName('tbody')[0];
			const rowCount = table.rows.length + 1;
			const row = table.insertRow();
			row.innerHTML = `
			<td>${rowCount}</td>
			<td><input type="text" value="${value}" /></td>
			<td><button type="button" onclick="removeSpecRow(this)">삭제</button></td>
		`;
			input.value = '';
			updateSpecRowNumbers();
		}
		function removeSpecRow(btn) {
			const row = btn.closest('tr');
			row.parentNode.removeChild(row);
			updateSpecRowNumbers();
		}
		function updateSpecRowNumbers() {
			const table = document.getElementById('spec-table').getElementsByTagName('tbody')[0];
			Array.from(table.rows).forEach((row, idx) => {
				row.cells[0].textContent = idx + 1;
			});
		}
	</script>

	<script src="/js/top.js"></script>

	<script>
		let currentTh = null;
		let currentOrder = 'desc';

		function order(thValue) {//정렬
			const allArrows = document.querySelectorAll("th a");
			allArrows.forEach(a => a.textContent = '↓');

			if (currentTh === thValue) {
				currentOrder = currentOrder === 'desc' ? 'asc' : 'desc';
			} else {
				currentOrder = 'asc';
				currentTh = thValue;
			}

			const arrow = thValue.querySelector('a');
			arrow.textContent = currentOrder === 'asc' ? '↑' : '↓';
		}





		//Modal ~ 
		function openModal() {
			const title = document.getElementById('modalTitle');
			title.textContent = '신규 BOM 등록';
			document.getElementById('modal').style.display = 'flex';
			document.querySelector('#modalForm button[name="save"]').style.display = 'block';
			document.querySelector('#modalForm button[name="edit"]').style.display = 'none';
		}

		function closeModal() {
			document.getElementById('modal').style.display = 'none';
		}

		function outsideClick(e) {
			if (e.target.id === 'modal') {
				closeModal();
			}
		}



		function submitModal(event) {
			event.preventDefault();
			const siteName = document.querySelector('#modalForm input[name="siteName"]').value;
			console.log(currentTab + ' 등록됨:', siteName);
			closeModal();
		}

		//테이블 클릭 시 출력되는 modal
		function opendatail() {
			openModal();
			document.getElementById('modalTitle').textContent = 'BOM 수정';

			document.querySelector('#modalForm button[name="save"]').style.display = 'none';
			document.querySelector('#modalForm button[name="edit"]').style.display = 'block';
		}



		function openCategoryModal() {
			document.getElementById('modal-category').style.display = 'flex';
		}
		function openSpecModal() {
			document.getElementById('modal-spec').style.display = 'flex';
		}
		function closeModal(modalId) {
			document.getElementById(modalId).style.display = 'none';
		}
		function outsideClick(e, modalId) {
			if (e.target.id === modalId) {
				closeModal(modalId);
			}
		}
		
		document.addEventListener('DOMContentLoaded', () => {
			  document.querySelectorAll('table').forEach(table => {
				const firstCells = table.querySelectorAll('tbody tr td:first-child');
				firstCells.forEach(td => {
				  td.setAttribute('onclick', 'event.stopPropagation()');
				});
			  });

			  // 페이지네이션 버튼 이벤트
			  document.getElementById('btn-prev-page').addEventListener('click', function() {
				  // 이전 페이지 이동 로직
			  });
			  document.getElementById('btn-next-page').addEventListener('click', function() {
				  // 다음 페이지 이동 로직
			  });
			});
	</script>

</body>

</html>